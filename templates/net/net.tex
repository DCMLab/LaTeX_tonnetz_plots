\documentclass{standalone}

\usepackage{bnumexpr}
\usepackage{pgfmath}
\usepackage[usenames,dvipsnames,table]{xcolor}
\usepackage{xstring}
\usepackage{ifthen}
\usepackage{tikz}
\usetikzlibrary{
  shapes, % for hexagons
  calc    % perform calculations within TikZ
}

\begin{document}

%%%% DEFINITIONS

% declare layers and specify ordering
\pgfdeclarelayer{bbg}       % behind background
\pgfdeclarelayer{bg}        % background
\pgfdeclarelayer{main}      % main layer
\pgfdeclarelayer{fg}        % foreground
\pgfdeclarelayer{bfg}       % before foreground
\pgfsetlayers{bbg,bg,main,fg,bfg}

% adjust size
\def\minx{-3}   % descending perfect fifths from C = 0
\def\maxx{3}    % ascending perfect fifths from C = 0
\def\miny{-3}   % descending major thirds from C = 0
\def\maxy{3}    % ascending major thirds from C = 0

% Diatonics
\def\diatonic{F, C, G, D, A, E, B}
\def\doubleflats{F$\flat\flat$, C$\flat\flat$, G$\flat\flat$, D$\flat\flat$, A$\flat\flat$, E$\flat\flat$, B$\flat\flat$}
\def\flats{F$\flat$, C$\flat$, G$\flat$, D$\flat$, A$\flat$, E$\flat$, B$\flat$}
\def\sharps{F$\sharp$, C$\sharp$, G$\sharp$, D$\sharp$, A$\sharp$, E$\sharp$, B$\sharp$}
\def\doublesharps{F$\sharp\sharp$, C$\sharp\sharp$, G$\sharp\sharp$, D$\sharp\sharp$, A$\sharp\sharp$, E$\sharp\sharp$, B$\sharp\sharp$}
% get accidentals
% if divmod(z,7) = 0 => ""
% else if divmod(z,7)< 0 => res * \flat
% else if divmod(z,7) > 0 => res * \sharp

% line of fifths
\newcommand*{\LoF}{\doubleflats,\flats,\diatonic,\sharps,\doublesharps}

% Tonnetz coordinates in x=fifths and y=major thirds
\newcommand*{\ftcoord}[2]{($#1*(1,0)+#2*(60:1)$)}

% access lists by index
\newcommand*\GetItem[2]{\StrBetween[#2,\number\numexpr#2+1]{,#1,},,\par}%

%%%% STYLES

\tikzstyle{tone}=[circle, draw=black, fill=white, minimum size=3em]
\tikzstyle{interval}=[draw=black, thick]
\tikzstyle{hexagon}=[draw=black!9, fill=black!4,regular polygon, regular polygon sides=6, rotate=30]

\begin{tikzpicture}[scale=2]
    \foreach \x in {\minx, ..., \maxx} {
        \foreach \y [evaluate=\y as \z using {int(\x+4*\y+16)}] in {\miny, ..., \maxy} { 

            % get label
            \def\l{\GetItem{\LoF}{\z}}

            % draw labels (pitch classes)
            \begin{pgfonlayer}{fg}
                \node [tone] at \ftcoord{\x}{\y} {\l};
            \end{pgfonlayer}

            % draw hexagons
            \begin{pgfonlayer}{bg}
                \node[hexagon,scale=5.5] at \ftcoord{\x}{\y} {};
            \end{pgfonlayer}

            % draw intervals
            \begin{pgfonlayer}{main}
                \ifthenelse{\x<\maxx-1}{
                    \draw [interval] \ftcoord{\x}{\y} -- \ftcoord{\x+1}{\y}; % P5s
                }{}
                \ifthenelse{\y<\maxy}{
                    \draw [interval] \ftcoord{\x}{\y} -- \ftcoord{\x}{\y+1}; % M3s
                }{}
                \ifthenelse{\x>\minx\AND\y<\maxy}{
                    \draw [interval] \ftcoord{\x}{\y} -- \ftcoord{\x-1}{\y+1}; % m3s
                }{}
            \end{pgfonlayer}
        }
    }

\end{tikzpicture}

\end{document}